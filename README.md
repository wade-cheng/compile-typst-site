# compile-typst-site

`compile-typst-site` is a binary utility for static site generation using Typst. It handles passing binary data like CSS files and compilation of Typst files to HTML. It can watch for changes and only recompile Typst files that have changed, or the entire project if a template has been changed.

To be specific, we do not supply a templating engine. The use case for one can be solved with native Typst. _All this CLI does is try to copy and compile files in a smart way_.

## installation

You must install [Typst](https://typst.app/open-source/#download).

See the [releases](https://github.com/wade-cheng/compile-typst-site/releases) to install from a precompiled binary.

### cargo-binstall

If you know what this is, yes, we support this.

```
cargo binstall --git https://github.com/wade-cheng/compile-typst-site.git
```

### compile from source

You probably know what you're doing.

```
cargo install --git https://github.com/wade-cheng/compile-typst-site.git
```

## examples

With `just` and `python` installed, `cd` to `examples/typst-site-full` and use `compile-typst-site`. You will need to supply an HTML server. Try `python -m http.server --directory _site`—the site will then be available at <http://localhost:8000/>.

## reference

`compile-typst-site` expects to be called somewhere under the following directory structure:

```
.
├── src/
├── templates/
└── compile-typst-site.toml
```

That is, just like `cargo`, `just`, `uv`, and so on, you can use the binary while in a subdirectory for the project root.

When you do so, it "compiles" every file in `src`.

- Typst files are "compiled" by calling your local Typst CLI, so you should have one installed.
- It also "compiles" files matching those in the `passthrough_copy` array in `compile-typst-site.toml`. These files are simply copied over. Matching can use globs, processed with the `globset` crate. This is probably unidiomatic to file paths (`*` matches recursively instead of just the first layer).
- Other files are ignored.

If file watching is turned on, changes or additions to `src` will only recompile that file. Changes or additions to `templates` will recompile the entire project.

See `compile-typst-site --help` and the example for more details.

The config file matches

```
struct Config {
    /// Array of globs to match for passthrough-copying.
    passthrough_copy: Option<Vec<String>>,
    /// Command to run before a full rebuild.
    ///
    /// E.g., `["echo", "rebuilding"]`.
    init: Option<Vec<String>>,
    /// Command to run to post-process HTML files generated by Typst.
    ///
    /// Must take in stdin and return via stdout.
    ///
    /// E.g., `["python", "post_processing_script.py"]`.
    post_processing_typ: Option<Vec<String>>,
}
```
